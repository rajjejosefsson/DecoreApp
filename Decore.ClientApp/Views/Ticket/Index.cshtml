@using System.Web.Mvc.Html

@model Decore.ClientApp.ViewModels.TicketViewModel
@{
    ViewBag.Title = "Index";
}

<style>
    tr.first {
        background-color: #FFA112;
        color: white;
    }

    .table-holder {
       border-radius: 7px;
        box-shadow: 0px 0px 19px 0px rgba(0, 0, 0, 0.16);
    }
</style>

<div class="row event" id="myTable">
    <div class="col-sm-8 col-sm-offset-2 col-md-8 col-md-offset-2">
        <div class="my-account">                  
            <div class="bottom-padding">
                <div class="title-box">
                    <h3>Nyligen köpta biljetter</h3>
                </div>
                <!-- Table  -->
                <div class="table-holder table-responsive">
                    <table class="table table-striped table-bordered table-responsive text-left my-orders-table">
                        <thead>
                        <tr class="first last">
                            <th>Event</th>
                            <th>Köptes</th>
                            <th><span class="nobr">Antal Biljetter</span></th>
                            <th>Pris</th>
                        </tr>
                        </thead>
                        <tbody>
                        @foreach (var ticket in Model.Tickets.OrderByDescending(Model => Model.BoughtAt)) {

                            <tr>
                               
                                <td>
                                 
                                    @foreach (var eventObj in Model.Events) {
                                        if (ticket.EventId == @eventObj.Id)
                                        {
                                           @eventObj.Title

                                        }

                                    }
                                </td>

                                <td>@ticket.BoughtAt</td>
                                <td>@(Model.TicketsSold.ContainsKey(ticket.EventId)?Model.TicketsSold[ticket.EventId].ToString():"0")/@{
                                    foreach(var e in Model.Events)
                                    {
                                        if(ticket.EventId == e.Id)
                                        {
                                            @e.MaxTickets;
                                        }
                                    }
                                }</td>
                              
                                <td><span class="price">
                                        @foreach (var eventObj in Model.Events)
                                        {
                                            if (eventObj.Id == @ticket.EventId)
                                            {
                                                @eventObj.BasePrice
                                            }
                                        }</span>
                                </td>
                                

                            </tr>

                        }

                        </tbody>
                    </table>
                </div>
                <!-- /Table  -->
            </div>
        </div>
    </div>
</div>